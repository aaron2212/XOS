<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">

<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>sfs.c</title><link rel="stylesheet" type="text/css" href="../styles/main.css" /><script type="text/javascript" src="../styles/main.js"></script><script type="text/javascript">NDLoader.LoadJS("Content", "../styles/");</script></head>

<!-- Generated by Natural Docs, version 2.0.2 -->

<!-- saved from url=(0016)http://localhost -->

<body onload="NDLoader.OnLoad('Content');" class="NDPage NDContentPage">

<a name="Functions"></a><a name="Topic61"></a><div class="CTopic TGroup LC first">
 <div class="CTitle">Functions</div>
</div>

<a name="init"></a><a name="Topic62"></a><div class="CTopic TFunction LC">
 <div class="CTitle">init</div>
 <div id="NDPrototype62" class="NDPrototype NoParameterForm"><span class="SHKeyword">void</span> init()</div>
 <div class="CBody"><p>Initialize the SFS filesystem by copying information into its superblock</p></div>
</div>

<a name="open"></a><a name="Topic63"></a><div class="CTopic TFunction LC">
 <div class="CTitle">open</div>
 <div id="NDPrototype63" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">FILE* open(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">filename&nbsp;</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Open a file</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">filename<div class="CDLParameterType"><span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>the name of the file to open</p></td></tr></table><div class="CHeading">Returns</div><p>A pointer to a FILE structure representing the opened file</p></div>
</div>

<a name="read"></a><a name="Topic64"></a><div class="CTopic TFunction LC">
 <div class="CTitle">read</div>
 <div id="NDPrototype64" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">int</span> read(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first">FILE&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">stream,</td></tr><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">buf,</td></tr><tr><td class="PType first">size_t&nbsp;</td><td></td><td class="PName last">len</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Read from a file</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">stream<div class="CDLParameterType">FILE*</div></td><td class="CDLDefinition"><p>the stream to read from</p></td></tr><tr><td class="CDLEntry">buf<div class="CDLParameterType"><span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>the buffer to read into</p></td></tr><tr><td class="CDLEntry">len<div class="CDLParameterType">size_t</div></td><td class="CDLDefinition"><p>the number of bytes to read</p></td></tr></table><div class="CHeading">Returns</div><p>The number of bytes read from the file. This is either <u>len</u> bytes, or the number of bytes read up until the end of the file</p></div>
</div>

<a name="create"></a><a name="Topic65"></a><div class="CTopic TFunction LC">
 <div class="CTitle">create</div>
 <div id="NDPrototype65" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters">FILE* create(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">filename</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Create an empty file</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">filename<div class="CDLParameterType"><span class="SHKeyword">char</span>*</div></td><td class="CDLDefinition"><p>the name of the file to create</p></td></tr></table><div class="CHeading">Returns</div><p>A pointer to a FILE structure representing the newly created file</p><div class="CHeading">See Also</div><p><a href="../index.html#File:sfs.c:open" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,63);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >open</a></p></div>
</div>

<a name="changedir"></a><a name="Topic66"></a><div class="CTopic TFunction LC">
 <div class="CTitle">changedir</div>
 <div id="NDPrototype66" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">int</span> changedir(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">dirname</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Change the current working directory</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">dirname</td><td class="CDLDefinition"><p>the name of the directory to change to</p></td></tr></table><div class="CHeading">Returns</div><p>0 on success, -1 on failure (directory does not exist, for example)</p></div>
</div>

<a name="closedir"></a><a name="Topic67"></a><div class="CTopic TFunction LC">
 <div class="CTitle">closedir</div>
 <div id="NDPrototype67" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">int</span> closedir(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first">DIR&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">dir</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Close a directory previously opened via a call to opendir</p><div class="CHeading">Parameters</div><table class="CDefinitionList"><tr><td class="CDLEntry">dir<div class="CDLParameterType">DIR*</div></td><td class="CDLDefinition"><p>the opened directory to close</p></td></tr></table><div class="CHeading">Returns</div><p>0 on success, -1 on failure</p><div class="CHeading">See Also</div><p>&lt;opendir&gt;</p></div>
</div>

<a name="rm"></a><a name="Topic68"></a><div class="CTopic TFunction LC">
 <div class="CTitle">rm</div>
 <div id="NDPrototype68" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">bool</span> rm(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">filename</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Remove a file from the filesystem by marking it as a deleted file entry</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">filename</td><td class="CDLDefinition"><p>the name of the file to remove</p></td></tr></table><div class="CHeading">Returns</div><p>True on success, false on failure</p></div>
</div>

<a name="rmdr"></a><a name="Topic69"></a><div class="CTopic TFunction LC">
 <div class="CTitle">rmdr</div>
 <div class="CBody"><p>Remove a directory from the filesystem by marking it as a deleted directory entry</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">filename</td><td class="CDLDefinition"><p>the name of the file to remove</p></td></tr></table><div class="CHeading">Returns</div><p>True on success, false on failure</p></div>
</div>

<a name="get_entry_name_by_offset"></a><a name="Topic70"></a><div class="CTopic TFunction LC">
 <div class="CTitle">get_entry_name_by_offset</div>
 <div id="NDPrototype70" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">char</span>* get_entry_name_by_offset(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">pos</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Get the name of an entry given its offset in the filesystem</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">pos</td><td class="CDLDefinition"><p>the offset of the file in the filesystem</p></td></tr></table><div class="CHeading">Returns</div><p>The name of the file, or a NULL pointer</p></div>
</div>

<a name="get_offset_by_entry_name"></a><a name="Topic71"></a><div class="CTopic TFunction LC">
 <div class="CTitle">get_offset_by_entry_name</div>
 <div id="NDPrototype71" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">unsigned</span> <span class="SHKeyword">char</span>* get_offset_by_entry_name(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">name</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>This function does the reverse of <u>get entry name by offset</u>. It gets the offset of a file in the filesystem given its name (full path)</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">name</td><td class="CDLDefinition"><p>the name of the file whose offset is returned</p></td></tr></table><div class="CHeading">Returns</div><p>A pointer to the offset of the file in the filesystem</p></div>
</div>

<a name="get_full_name"></a><a name="Topic72"></a><div class="CTopic TFunction LC">
 <div class="CTitle">get_full_name</div>
 <div id="NDPrototype72" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">char</span>* get_full_name(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">unsigned</span>&nbsp;</td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">pos</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Get the full name of the entry given its position in the filesystem.&nbsp; This function is needed to merge filenames which exist across multiple entries (through the user of continuation entries)</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">pos</td><td class="CDLDefinition"><p>a pointer to the offset of the file in the filesystem</p></td></tr></table><div class="CHeading">Returns</div><p>The full name of the file</p></div>
</div>

<a name="find_all_entries"></a><a name="Topic73"></a><div class="CTopic TFunction LC">
 <div class="CTitle">find_all_entries</div>
 <div id="NDPrototype73" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> find_all_entries(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PModifierQualifier first"><span class="SHKeyword">struct</span>&nbsp;</td><td class="PType"><a href="../index.html#File:sfs.h:entry" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,51);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >entry</a>&nbsp;</td><td class="PName last">entries[]</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Populate an array of <u>entry</u> structs with with a list of entries found in the filesystem</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">entries</td><td class="CDLDefinition"><p>the array to populating with all the entries in the filesystem</p></td></tr></table></div>
</div>

<a name="get_entry_names"></a><a name="Topic74"></a><div class="CTopic TFunction LC">
 <div class="CTitle">get_entry_names</div>
 <div id="NDPrototype74" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">void</span> get_entry_names(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="first"></td><td class="PType"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">**</td><td class="PName last">entry_names,</td></tr><tr><td class="PModifierQualifier first"><span class="SHKeyword">struct</span>&nbsp;</td><td class="PType"><a href="../index.html#File:sfs.h:entry" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,51);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >entry</a>&nbsp;</td><td></td><td class="PName last">entries[],</td></tr><tr><td class="first"></td><td class="PType"><span class="SHKeyword">int</span>&nbsp;</td><td></td><td class="PName last">_entry_type</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Get a list of names of the entries in the filesystem. This is only done for directory entries and file entries</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">entry_names</td><td class="CDLDefinition"><p>the list to fill with the names of the entries</p></td></tr><tr><td class="CDLEntry">entries</td><td class="CDLDefinition"><p>the array which contains a list of <u>entry</u> structs received from a previous call to <u>find all entries</u></p></td></tr><tr><td class="CDLEntry">_entry_type</td><td class="CDLDefinition"><p>the types of entries to find in the filesystem. This is an integer consisting of entry types which have been bitwise ORed together</p></td></tr></table><div class="CHeading">See Also</div><p><a href="../index.html#File:sfs.c:find_all_entries" target="_top" onmouseover="NDContentPage.OnLinkMouseOver(event,73);" onmouseout="NDContentPage.OnLinkMouseOut(event);" >find_all_entries</a></p></div>
</div>

<a name="count_files_and_dirs"></a><a name="Topic75"></a><div class="CTopic TFunction LC">
 <div class="CTitle">count_files_and_dirs</div>
 <div id="NDPrototype75" class="NDPrototype NoParameterForm"><span class="SHKeyword">void</span> count_files_and_dirs()</div>
 <div class="CBody"><p>Count the number of files and directories in the file system by checking each entry's type. The results are stored in 2 separate global variables <u>total rootfs dirs</u> and <u>total rootfs files</u></p></div>
</div>

<a name="is_filename_valid"></a><a name="Topic76"></a><div class="CTopic TFunction LC">
 <div class="CTitle">is_filename_valid</div>
 <div id="NDPrototype76" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">bool</span> is_filename_valid(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">filename</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Determine if a filename is valid. A filename is invalid if it contains the following characters: - control character s(below 0x20) - &quot; (0x22) - * (0x2A) - : (0x3A) - &lt; (0x3C) - &gt; (0x3E) - ? (0x3F) - \ (0x5C) - DEL (0x7F) The no break space character (0xA0) is replaced with a space (0x20)</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">filename</td><td class="CDLDefinition"><p>the name of the fild whose validity will be determined</p></td></tr></table><div class="CHeading">Returns</div><p>True if the name of the file is valid, false otherwise</p></div>
</div>

<a name="path_exists"></a><a name="Topic77"></a><div class="CTopic TFunction LC">
 <div class="CTitle">path_exists</div>
 <div class="CBody"><p>Determine if a path exists in the filesystem</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">path</td><td class="CDLDefinition"><p>the path to check for existence</p></td></tr></table><div class="CHeading">Returns</div><p>True if the path exists, false otherwise</p></div>
</div>

<a name="is_dir"></a><a name="Topic78"></a><div class="CTopic TFunction LC">
 <div class="CTitle">is_dir</div>
 <div id="NDPrototype78" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">bool</span> is_dir(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">path</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Determine if a path is a directory</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">path</td><td class="CDLDefinition"><p>the path to check</p></td></tr></table><div class="CHeading">Returns</div><p>True if the path is a directory, false otherwise</p></div>
</div>

<a name="is_file"></a><a name="Topic79"></a><div class="CTopic TFunction LC last">
 <div class="CTitle">is_file</div>
 <div id="NDPrototype79" class="NDPrototype WideForm CStyle"><table><tr><td class="PBeforeParameters"><span class="SHKeyword">bool</span> is_file(</td><td class="PParametersParentCell"><table class="PParameters"><tr><td class="PType first"><span class="SHKeyword">char</span>&nbsp;</td><td class="PNamePrefix">*</td><td class="PName last">path</td></tr></table></td><td class="PAfterParameters">)</td></tr></table></div>
 <div class="CBody"><p>Determine if a path is a file</p><div class="CHeading">Paramaters</div><table class="CDefinitionList"><tr><td class="CDLEntry">path</td><td class="CDLDefinition"><p>the file to check</p></td></tr></table><div class="CHeading">Returns</div><p>True if the file is a directory, false otherwise</p></div>
</div>

</body></html>